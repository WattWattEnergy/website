<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8" />
    <title>WattWatt - Solar Crowdfunding</title>
    <base href="/" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
  </head>

  <body class="mode">
    <app-root></app-root>

    <script src="https://verify.sendwyre.com/js/widget-loader.js"></script>
    <script>
      // configure the widget for metamask authentication
      var widget = new Wyre.Widget({
        env: "test",
        // type: "debitcard",
        accountId: "AC-EPLB2VQTJNH",
        auth: { type: "metamask" },
        operation: {
          type: "debitcard",
          dest: "ethereum:0x98B031783d0efb1E65C4072C6576BaCa0736A912",
          sourceCurrency: "USD",
          destCurrency: "DAI",
          destAmount: 0.03
        },
      });
    </script>

    <script>
      function  Transfer1() {
    console.log('Wyre Transfer');
    widget.open();

    var transfer1 = new Wyre.Widget({
      env: "test",
      accountId: "AC-EPLB2VQTJNH",
      auth: { type: "default" },
      operation: {
        type: "debitcard",
        dest: "ethereum:0x98B031783d0efb1E65C4072C6576BaCa0736A912",
        sourceCurrency: "USD",
        destCurrency: "DAI",
        destAmount: 0.02
      },
      autoConfirm:true 
    });
  };


  function Transfer2() {
    widget.open();

    var transfer2 = new Wyre.Widget({
      env: "test",
      accountId: "AC-EPLB2VQTJNH",
      auth: { type: "secretKey",
      secretKey: "testertestertestertestertestertester" },
      operation: {
        type: "onramp",
        dest: "ethereum:0x98B031783d0efb1E65C4072C6576BaCa0736A912",
        sourceCurrency: "USD",
        destCurrency: "DAI",
        destAmount: 0.03
      }
    });
  };
    </script>

    <!-- <script>
      function PayT() {
        console.log("Sending Fake Ether!");
        // const Web3 = require('web3');
        var escrowContract = "0x472d5b09ff3086006953d6d59d0f35b0cf310b6a";

        var src = web3.eth.accounts[0];
        var payee = "0x76c67F724d155bf2725350bDF809460f5636bEc9";

        var Amount = 0.1;
        var B = web3.toWei(Amount, "ether");
        
        var payContractABI = [
          {
            constant: false,
            inputs: [
              {
                name: "recipient",
                type: "address"
              }
            ],
            name: "transferPrimary",
            outputs: [],
            payable: false,
            stateMutability: "nonpayable",
            type: "function"
          },
          {
            constant: false,
            inputs: [
              {
                name: "payee",
                type: "address"
              }
            ],
            name: "withdraw",
            outputs: [],
            payable: false,
            stateMutability: "nonpayable",
            type: "function"
          },
          {
            constant: true,
            inputs: [],
            name: "primary",
            outputs: [
              {
                name: "",
                type: "address"
              }
            ],
            payable: false,
            stateMutability: "view",
            type: "function"
          },
          {
            constant: true,
            inputs: [
              {
                name: "payee",
                type: "address"
              }
            ],
            name: "depositsOf",
            outputs: [
              {
                name: "",
                type: "uint256"
              }
            ],
            payable: false,
            stateMutability: "view",
            type: "function"
          },
          {
            constant: false,
            inputs: [
              {
                name: "payee",
                type: "address"
              }
            ],
            name: "deposit",
            outputs: [],
            payable: true,
            stateMutability: "payable",
            type: "function"
          },
          {
            anonymous: false,
            inputs: [
              {
                indexed: true,
                name: "payee",
                type: "address"
              },
              {
                indexed: false,
                name: "weiAmount",
                type: "uint256"
              }
            ],
            name: "Deposited",
            type: "event"
          },
          {
            anonymous: false,
            inputs: [
              {
                indexed: true,
                name: "payee",
                type: "address"
              },
              {
                indexed: false,
                name: "weiAmount",
                type: "uint256"
              }
            ],
            name: "Withdrawn",
            type: "event"
          }
        ];
        var PayContract = web3.eth.contract(payContractABI);
        var payContract = PayContract.at(escrowContract);
        console.log(payContract);
        console.log(B);
        payContract.deposit(payee, { gas: 2000000, value: B }, console.log);

        var accountInterval = setInterval(function() {
          // Check if account has changed
          if (web3.eth.accounts[0] !== src) {
            src = web3.eth.accounts[0];
          }
        }, 10000);

        async function waitForTxToBeMined(txHash) {
          let txReceipt;
          while (!txReceipt) {
            try {
              txReceipt = await eth.getTransactionReceipt(txHash);
              console.log("Transaction Hash:" (txHash));
            } catch (err) {
              return indicateFailure(err);
            }
          }
        }
      }
    </script> -->
  </body>
</html>
